\documentclass{article}
\usepackage{tikz}
\usepackage{float}
\usepackage{enumerate}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{bm}
\usepackage{indentfirst}
\usepackage{siunitx}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\graphicspath{ {Images/} }
\usepackage{float}
\usepackage{mhchem}
\usepackage{chemfig}
\allowdisplaybreaks

\title{6.041 Problem Set 3}
\author{Robert Durfee - R02}
\date{September 25, 2018}

\begin{document}

\maketitle

\section*{Problem 1}

\textit{You are given the set of letters $ \{ A, B, C, D, E \} $. What is the
probability that in a random five-letter string (in which each letter appears
exactly once, and with all such strings equally likely) the letters $ A $, $
B $ and $ D $ are next to each other (in no particular order)?}

\bigbreak

Since, $ A $, $ B $, and $ D $ must stay together, when assembling a sequence,
you have to choose from $ \{ A, B, D \}^* $, $ C $, or $ E $. Let's first
fix the the first element to be $ \{ A, B, D \}^* $:
$$ ( \{ A, B, D \}^*, \star, \star ) $$
The size of sequences of this form is given by
$$ | \{ A, B, D \}^* | \cdot 2 \cdot 1 = (3 \cdot 2 \cdot 1) \cdot 2 \cdot 1
= 12 $$
Now, since we fixed the location of $ \{ A, B, D \}^* $, we must look at how
many other ways there are to position $ \{ A, B, C \}^* $. There are $
\binom{3}{1} = 3 $ different ways to do this. Therefore, the total number of
sequences of this form must be
$$ ((3 \cdot 2 \cdot 1) \cdot 2 \cdot 1) \cdot 3 = 36 $$

Now the total number of sequences $ \{ A, B, C, D, E \}^* $ is given by
$$ 5 \cdot 4 \cdot 3 \cdot 2 \cdot 1 = 5! = 120 $$
Therefore, the probability of getting this sequence, given all are equally
likely, must be
$$ \frac{36}{120} = \frac{3}{10} $$

\section*{Problem 2}

\textit{Alice plays the following game with Bob. First, Alice randomly
chooses a set of 5 cards out of a 52-card deck, memorizes them, and places
them back into the deck. (Any set of 5 cards is equally likely.) Then, Bob
randomly chooses 9 cards out of the same deck. (Any set of 9 cards is equally
likely.) Assume that the choice of 5 cards by Alice and the choice of 9 cards
by Bob are independent.}

\textit{What is the probability that all 5 cards Alice chose were also among
the 9 cards chosen by Bob?}

\bigbreak

The five cards that Alice draws does nothing other than restrict the cards that
Bob can draw. The values of Alice's cards is not important.

First, let's fix the locations of Alice's cards to be the first cards in the
sequence of cards drawn by Bob:
$$ ( \{ A_0, A_1, A_2, A_3, A_4 \}^*, \star, \star, \star, \star ) $$
The number of sequences in this form must then be:
$$ | \{ A_0, A_1, A_2, A_3, A_4 \}^* | \cdot \frac{(52 - 5)!}{(52 - 9)!} = 5!
\cdot \frac{47!}{43!} $$
However, since we fixed the location of $ \{ A_0, A_1, A_2, A_3, A_4 \}^* $,
we must look at how many other ways there are to fix $ \{ A_0, A_1, A_2, A_3,
A_4 \}^* $. There are $ \binom{9}{5} $ ways to do this. Therefore, the total
number of sequences of this form (where Alice's cards were drawn by Bob),
must be
$$ 5! \cdot \frac{47!}{43!} \cdot \binom{9}{5} = 5! \cdot \frac{47!}{43!}
\cdot \frac{9!}{4! \cdot 5!} = \frac{47!}{43!} \cdot \frac{9!}{4!} $$

Now, the total number of sequences of cards Bob could have drawn is given
$$ \frac{52!}{43!} $$
Therefore, the probability of getting all of Alices cards, given card sequences
are equally likely and Alice's draw is independent of Bob's, must be
$$ \frac{(47! \cdot 9!) / (43! \cdot 4!)}{52! / 43!} = \frac{ 47! \cdot 9! /
4! }{ 52! } = \frac{3}{61880} \approx 4.8 \cdot 10^{-5} $$

\section*{Problem 3}

\textit{Each one of $ n $ persons, indexed by $ 1, 2, \ldots, n $, has a
clean hat and throws it into a box. The persons then pick hats from the box,
at random. Every assignment of the hats to the persons is equally likely. In
an equivalent model, each person picks a hat, one at a time, in the order of
their index, with each one of the remaining hats being equally likely to be
picked. Find the probability of the following events.}

\subsection*{Part A}

\textit{Every person gets his or her own hat back.}

\bigbreak

There are $ n! $ different ways to distribute the hats back to everyone. Only
one of these ways will result in everyone getting their hat back. As a result,
the probability of this event occurring must be
$$ \frac{1}{n!} $$

\subsection*{Part B}

\textit{Each one of persons $ 1, \ldots, m $ gets his or her own hat back,
where $ 1 \leq m \leq n $.}

\bigbreak

The first person picks up his/her hat with a probability of $ 1 / n $. The
next person picks up his/her hat with probability of $ 1 / (n - 1) $. This
continues for all $ m $ persons. Therefore, the total probability of $ m $
persons getting their hats back is given by
$$ \frac{1}{n} \cdot \frac{1}{n - 1} \cdot \ldots \cdot \frac{1}{n - m + 1} =
\frac{(n - m)!}{n!} $$

Or, thinking in terms of sequences, there is only one way to assign the first
$ m $ hats to the first $ m $ people such that they get their hats back, so
we only need to consider how to arrange the remaining $ n - m $ hats. This is
given by $ (n - m)! $. There are a total of $ n! $ ways to arrange the hats,
therefore, the probability is also shown to be
$$ \frac{(n - m)!}{n!} $$

\subsection*{Part C}

\textit{Each one of persons $ 1, \ldots, m $ gets back a hat belonging to one
of the last $ m $ persons (persons $ n - m + 1, \ldots, n $), where $ 1 \leq 
m \leq n $.}

\bigbreak

For the first person, there are $ m $ different hats to choose from, each
equally likely. For the second person, there are $ m - 1 $ hats left to
choose from and so on until all $ m $ people picked up hats. Therefore, since
all hats are equally likely to be picked up, the probability of the first $ m
$ people picking up hats belonging to the last $ m $ people is given by
$$ \frac{1}{m} \cdot \frac{1}{m - 1} \cdot \ldots \cdot \frac{1}{m - m + 2}
\cdot 1 = \frac{1}{m!} $$

\bigbreak

\textit{Now assume, in addition, that every hat thrown into the box has
probability $ p $ of getting dirty (independently of what happens to the
other hats or who has dropped or picked it up). Find the probability that:}

\subsection*{Part D}

\textit{Persons $ 1, \ldots, m $ will pick up clean hats.}

\bigbreak

The first person picks up a clean hat with probability $ (1 - p) $. The same
goes for the second person, and so on. Therefore, the probability of the
first $ m $ persons picking up clean hats is given by
$$ (1 - p) \cdot (1 - p) \cdot \ldots \cdot (1 - p) = (1 - p)^m $$

\subsection*{Part E}

\textit{Exactly $ m $ persons will pick up clean hats.}

\bigbreak

Now, we also have to ensure that the last $ n - m + 1 $ people pick up dirty
hats. Therefore, the probability that the first $ m $ people pick up clean
hats and the last $ n - m + 1 $ people pick up dirty hats is given by
$$ (1 - p) \cdot (1 - p) \cdot \ldots \cdot (1 - p) \cdot p \cdot p \cdot
\ldots \cdot p = (1 - p)^m \cdot p^{n - m} $$
But this fixed the order in which the hats were picked up (all clean first,
then all dirty). Therefore, we must also consider how many different ways
in which the order could change. This is $ \binom{n}{m} $. Therefore, the
overall probability of exactly $ m $ clean hats being picked is given by
the binomial distribution
$$ \binom{n}{m} (1 - p)^m p^{n - m} $$

\section*{Problem 4}

\textit{A player is randomly dealt a sequence of 13 cards from a standard
52-card deck. All sequences of 13 cards are equally likely. In an equivalent
model, the cards are chosen and dealt one at a time. When choosing a card,
the dealer is equally likely to pick any of the cards that remain in the
deck.}

\subsection*{Part A}

\textit{What is the probability the 13th card dealt is a King?}

\bigbreak

Let's first consider the case when the last card drawn is the king of spades.
Then the sequence of drawn cards looks like
$$ ( \star, \star, \ldots, \star, K_S ) $$
The number of choices for the first card is $ 52 - 1 $, and the second $ 52 -
2 $, and so on. The last card is fixed, therefore its probability is $ 1 $.
Therefore, the number of sequences like this is
$$ (52 - 1)(52 - 2) \ldots (52 - 12) = \frac{(52 - 1)!}{(52 - 13)!} =
\frac{51!}{39!} $$
But, since we chose the king to be of spades, there are 3 other ways to make
a satisfying sequence. Therefore, the number of sequences with the last card
a king is
$$ 4 \cdot \frac{51!}{39!} $$
The total number of ways to draw $ 13 $ cards is given by
$$ \frac{52!}{39!} $$
Therefore, the total probability of having the last card be a king is given by
$$ \frac{4 \cdot 51! / 39!}{52! / 39!} = \frac{1}{13} $$
This is the same probability of just drawing a king from the deck.

\subsection*{Part B}

\textit{Find the probability of the event that the 13th card dealt is the
first King dealt.}

\bigbreak

Once again, fixing the last card to be a king, the sequence of drawn cards
looks like
$$ ( \star, \star, \ldots, \star, K) $$
The number of choices for the first card are $ 52 - 4 $ (as no kings are
possible), and the second is $ 52 - 5 $, and so on. However, the choices for
the last card are $ 4 $ as there are four different kings to choose from.
Therefore, the number of sequences like this is
$$ (52 - 4) (52 - 5) \ldots (52 - 15) \cdot 4 = \frac{4 \cdot (52 - 4)!}{(52
- 16)!} = 4 \cdot \frac{48!}{36!} $$
The total number of ways to draw $ 13 $ cards is the same as before,
$$ \frac{52!}{39!} $$
Therefore, the total probability of having the last card be the first king is
given by
$$ \frac{ 4 \cdot 48! / 36!}{52! / 39!} = \frac{703}{20825} $$

\section*{Problem 5}

\textit{The newest invention of the 6.041A staff is a three-sided die. On any
roll of this die, the result is 1 with probability 1/2, 2 with probability
1/4, and 3 with probability 1/4. Consider a sequence of six independent rolls
of this die.}

\subsection*{Part A}

\textit{Find the probability that exactly two of the rolls result in a 3.}

\bigbreak

The probability that two of six rolls of this die result in a 3 is given by
the binomial distribution where probability of success $ p = 1/4 $. Therefore,
the probability is
$$ \binom{6}{2} (1/4)^2 (1 - 1/4)^{6 - 2} = \frac{1215}{4096} $$

\subsection*{Part B}

\textit{Given that exactly two of the six rolls resulted in a 1, find the
probability that the first roll resulted in a 1.}

\bigbreak

Let $ A $ be the event that the first roll is a $ 1 $. Let $ B $ be the event
that exactly two of the six rolls resulted in a $ 1 $. Then
$$ P(A \mid B) = \frac{P(A \cap B)}{P(B)} $$
The probability of $ B $ is given by the binomial distribution with
probability of success $ p = 1/2 $. Thus,
$$ P(B) = \binom{6}{2} (1/2)^2 (1-1/2)^{6 - 2} $$
The probability of $ A \cap B $ is the same as the probability of first
rolling a $ 1 $ and then exactly one of the next five rolls is a $ 1 $.
The probability of the former is just $ 1/2 $ and the probability of the
latter is given by the binomial distribution with probability of success $ p
= 1/2 $. Since the rolls are independent, these probabilities can be
multiplied. Thus,
$$ P(A \cap B) = (1/2) \binom{5}{1} (1/2)^1 (1 - 1/2)^{5 - 1} $$
Therefore, the overall probability of the first roll being a $ 1 $ given that
exactly two $ 1 $'s were rolled is given by
$$ P(A \mid B) = \frac{P(A \cap B)}{P(B)} = \frac{(1/2) \binom{5}{1} (1/2)^1
(1 - 1/2)^{5 - 1}}{\binom{6}{2} (1/2)^2 (1-1/2)^{6 - 2}} = \frac{1}{3} $$

\subsection*{Part C}

\textit{We are told that exactly three of the rolls resulted in a 1 and
exactly three rolls resulted in a 2. Given this information, find the
probability that the six rolls resulted in the sequence $ (1, 2, 1, 2, 1, 2)
$.}

\bigbreak

Let $ A $ be the event that the sequence $ (1, 2, 1, 2, 1, 2) $ was rolled.
Let $ B $ be the event that exactly three 1's and three 2's were rolled. Then,
the probability $ P(A \mid B) $ is given by
$$ P(A \mid B) = \frac{P(A \cap B)}{P(B)} $$

First, determining the probability of $ B $. Let's first consider the case
where the first three rolls were 1's and the last three rolls were 2's. That
is, the sequence looks like
$$ (1, 1, 1, 2, 2, 2) $$
Since the rolls are independent, the probabilty of this sequence is
$$ (1/2)(1/2)(1/2)(1/4)(1/4)(1/4) = (1/2)^3 (1/4)^3 $$
But, there are $ \binom{6}{2} $ different ways that this sequence can be
arranged, all with equal probability. Therefore, the probability of exactly
three 1's and three 2's is given by
$$ P(B) = \binom{6}{2} (1/2)^3 (1/4)^3 $$

Now, determing the probability of $ A \cap B $. There is only one sequence
that satisfies this condition. The probability is given by
$$ (1/2)^3 (1/4)^3 $$

Therefore, the probability of rolling $ (1, 2, 1, 2, 1, 2) $ given rolling
exactly three 1's and three 2's is
$$ \frac{ (1/2)^3 (1/4)^3 }{\binom{6}{3} (1/2)^3 (1/4)^3} = \frac{1}{20} $$

\subsection*{Part D}

\textit{Find the conditional probability that exactly $ k $ rolls resulted in
a 3, given that at least one roll resulted in a 3.}

\bigbreak

Let $ A $ be the event that exactly $ k $ 3's are rolled and $ B $ be the
event that at least one 3 was rolled. Then, the probability $ P(A \mid B) $
is given by
$$ P(A \mid B) = \frac{P(A \cap B)}{P(B)} $$

First, determining the probability of $ B $. The probability of at least one
3 is equal to 1 minus the probability of rolling no 3's. The probability of
rolling no 3's is simply the probability of rolling a 1, event $C$, or a 2,
event $D$ six times. And, since each roll is independent,
$$ P(B) = 1 - P(\overline{B}) = 1 - P(C \cup D)^6 $$
Also, since $ C $ and $ D $ are mutually exclusive,
$$ P(B) = 1 - (P(C) + P(D))^6 = 1 - (1/2 + 1/4)^6 $$

Next, determining the probability of $ A \cap B $. This is the statement
``exactly $k$ 3's were rolled and at least one 3 was rolled." This is the same
as saying ``exactly $k$ 3's were rolled for $ k > 0 $." Therefore, the probability
is given by the binomial distribution with probability of success $ p = 1/4 $
for $ k > 0 $, otherwise the probability is zero as you cannot roll exactly
zero 3's and at least one 3 at the same time.
$$ P(A \cap B) = \begin{cases}
    \binom{6}{k} (1/4)^k (1 - 1/4)^{6 - k} & k > 0 \\
    0 & k = 0
\end{cases} $$

Therefore, the probability of $ A \mid B $ is
$$ P(A \mid B) = \begin{cases}
    \frac{\binom{6}{k} (1/4)^k (1 - 1/4)^{6 - k}}{1 - (1/2 + 1/4)^6} & k > 0 \\
    0 & k = 0
\end{cases} $$

\section*{Problem 6}

\textit{We saw in Recitation 5 that the expected value of a random variable $
X $ that takes nonnegative integer values only, can be expressed by the
following formula:}
$$ E [X] = \sum\limits_{k=1}^{\infty} P(X \geq k) $$
\textit{Use this result to find the expectation of a random variable $ Y $
that takes positive integer values and whose $ PMF $ is:}
$$ p_Y(y) = (1 - \alpha) \alpha^{y - 1},\, y = 1, 2, \ldots $$
\textit{where $ 0 < \alpha < 1 $.}

\bigbreak

The definition of expected value is 
$$ E[Y] = \sum\limits_{y = 0}^{\infty} y p_Y(y) $$
Given the probability mass function for $ Y $, this becomes
$$ E[Y] = \sum\limits_{y = 0}^{\infty} y (1 - \alpha) \alpha^{y - 1} = (1 -
\alpha) \sum\limits_{y = 0}^{\infty} y \alpha^{y - 1} $$
Using the infinte geometric sum definition,
$$ \sum\limits_{y = 0}^{\infty} \alpha^y = \frac{\alpha}{1 - \alpha} $$
Taking the derivative of both sides with respect to $ \alpha $ yields
$$ \sum\limits_{y = 0}^{\infty} y \alpha^{y - 1} = \frac{1}{(1 - \alpha)^2} $$
Therefore, the expected value for $ Y $ is
$$ E[Y] = (1 - \alpha) \cdot \frac{1}{(1 - \alpha)^2} = \frac{1}{1 - \alpha} $$

\end{document}